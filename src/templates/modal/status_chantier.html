<!-- You can open the modal using ID.showModal() method -->

<dialog id="status_modal" class="modal">
  <div class="modal-box">
    <form method="dialog">
      <button class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2">✕</button>
    </form>
    
     <h3 class="font-bold text-lg mb-6 flex items-center gap-2">
        <svg style="width:20px; height:20px" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd"/>
        </svg>
        Changer le statut du chantier
    </h3>
    
    <div class="text-center mb-6">
        <p class="text-sm text-gray-500">{{ chantier.nom_chantier }}</p>
        <div class="badge badge-lg mt-2 
            {% if chantier.status_chantier == 'planification' %}badge-secondary
            {% elif chantier.status_chantier == 'en_cours' %}badge-info
            {% elif chantier.status_chantier == 'suspendu' %}badge-warning
            {% elif chantier.status_chantier == 'termine' %}badge-primary
            {% elif chantier.status_chantier == 'facturee' %}badge-success
            {% elif chantier.status_chantier == 'annule' %}badge-error
            {% endif %}">
            Statut actuel: {{ chantier.get_status_chantier_display }}
        </div>
    </div>
    
    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
        
        <!-- DÉMARRER / REPRENDRE -->
        {% if chantier.status_chantier != 'en_cours' and chantier.status_chantier != 'annule' and chantier.status_chantier != 'termine' %}
        <form method="post" action="{% url 'chantier_app:commencer-chantier' chantier.id %}" 
              class="card bg-base-100 shadow hover:shadow-md transition-shadow">
            <div class="card-body p-4" style="cursor: pointer;">
                {% csrf_token %}
                <button type="submit" class="w-full text-left">
                    <div class="flex items-center gap-3">
                        <div class="bg-success/10 p-2 rounded-lg">
                            <svg style="width:20px; height:20px" fill="currentColor" viewBox="0 0 20 20" class="text-success">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                        <div>
                            <h4 class="font-bold">Démarrer</h4>
                            <p class="text-sm opacity-70">Passer le chantier en cours</p>
                        </div>
                    </div>
                </button>
            </div>
        </form>
        {% endif %}
        
        <!-- TERMINER -->
        {% if chantier.status_chantier == 'en_cours' or chantier.status_chantier == 'suspendu' %}
        <form method="post" action="{% url 'chantier_app:terminer-chantier' chantier.id %}"
              class="card bg-base-100 shadow hover:shadow-md transition-shadow">
            <div class="card-body p-4" style="cursor: pointer;">
                {% csrf_token %}
                <button type="submit" class="w-full text-left">
                    <div class="flex items-center gap-3">
                        <div class="bg-primary/10 p-2 rounded-lg">
                            <svg style="width:20px; height:20px" fill="currentColor" viewBox="0 0 20 20" class="text-primary">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                        <div>
                            <h4 class="font-bold">Terminer</h4>
                            <p class="text-sm opacity-70">Marquer comme terminé</p>
                        </div>
                    </div>
                </button>
            </div>
        </form>
        {% endif %}
        
        <!-- SUSPENDRE -->
        {% if chantier.status_chantier == 'en_cours' %}
        <form method="post" action="{% url 'chantier_app:suspendre-chantier' chantier.id %}"
              class="card bg-base-100 shadow hover:shadow-md transition-shadow">
            <div class="card-body p-4" style="cursor: pointer;">
                {% csrf_token %}
                <button type="submit" class="w-full text-left">
                    <div class="flex items-center gap-3">
                        <div class="bg-warning/10 p-2 rounded-lg">
                            <svg style="width:20px; height:20px" fill="currentColor" viewBox="0 0 20 20" class="text-warning">
                                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                        <div>
                            <h4 class="font-bold">Suspendre</h4>
                            <p class="text-sm opacity-70">Mettre en pause temporaire</p>
                        </div>
                    </div>
                </button>
            </div>
        </form>
        {% endif %}
        
        <!-- REPRENDRE (quand suspendu) -->
        {% if chantier.status_chantier == 'suspendu' %}
        <form method="post" action="{% url 'chantier_app:commencer-chantier' chantier.id %}"
              class="card bg-base-100 shadow hover:shadow-md transition-shadow">
            <div class="card-body p-4" style="cursor: pointer;">
                {% csrf_token %}
                <button type="submit" class="w-full text-left">
                    <div class="flex items-center gap-3">
                        <div class="bg-info/10 p-2 rounded-lg">
                            <svg style="width:20px; height:20px" fill="currentColor" viewBox="0 0 20 20" class="text-info">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                        <div>
                            <h4 class="font-bold">Reprendre</h4>
                            <p class="text-sm opacity-70">Relancer le chantier suspendu</p>
                        </div>
                    </div>
                </button>
            </div>
        </form>
        {% endif %}
        
        <!-- REPLANIFIER -->
        {% if chantier.status_chantier != 'planification' and chantier.status_chantier != 'annule' and chantier.status_chantier != 'termine' %}
        <form method="post" action="{% url 'chantier_app:planifier-chantier' chantier.id %}"
              class="card bg-base-100 shadow hover:shadow-md transition-shadow">
            <div class="card-body p-4" style="cursor: pointer;">
                {% csrf_token %}
                <button type="submit" class="w-full text-left">
                    <div class="flex items-center gap-3">
                        <div class="bg-secondary/10 p-2 rounded-lg">
                            <svg style="width:20px; height:20px" fill="currentColor" viewBox="0 0 20 20" class="text-secondary">
                                <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                        <div>
                            <h4 class="font-bold">Replanifier</h4>
                            <p class="text-sm opacity-70">Retour en phase de planification</p>
                        </div>
                    </div>
                </button>
            </div>
        </form>
        {% endif %}
        
        <!-- ANNULER -->
        {% if chantier.status_chantier != 'annule' and chantier.status_chantier != 'termine' %}
        <form method="post" action="{% url 'chantier_app:annuler-chantier' chantier.id %}"
              class="card bg-base-100 shadow hover:shadow-md transition-shadow"
              onsubmit="return confirm('Êtes-vous sûr de vouloir annuler ce chantier ? Cette action est irréversible.')">
            <div class="card-body p-4" style="cursor: pointer;">
                {% csrf_token %}
                <button type="submit" class="w-full text-left">
                    <div class="flex items-center gap-3">
                        <div class="bg-error/10 p-2 rounded-lg">
                            <svg style="width:20px; height:20px" fill="currentColor" viewBox="0 0 20 20" class="text-error">
                                <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                        <div>
                            <h4 class="font-bold">Annuler</h4>
                            <p class="text-sm opacity-70">Annuler définitivement le chantier</p>
                        </div>
                    </div>
                </button>
            </div>
        </form>
        {% endif %}
  </div>
</dialog>


   